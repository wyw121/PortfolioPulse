(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{5397:(e,t,r)=>{Promise.resolve().then(r.bind(r,173))},173:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(7437),s=r(4693),n=r(495),i=r(6013),l=r(9088),c=r(1066);let o=(0,c.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var d=r(5733);let h=(0,c.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),u=(0,c.Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);var f=r(7138),x=r(2265);function m(){let[e,t]=(0,x.useState)([]),[r,c]=(0,x.useState)(!0),[m,g]=(0,x.useState)(null),[p]=(0,x.useState)(1),v=(0,x.useCallback)(async()=>{try{c(!0);let e=await l.Z.getAllPostsAdmin({page:p,page_size:20});t(e)}catch(e){g(e instanceof Error?e.message:"加载失败")}finally{c(!1)}},[p]);(0,x.useEffect)(()=>{v()},[v]);let j=async(r,a)=>{if(confirm("确定要删除文章《".concat(a,"》吗？此操作不可撤销。")))try{await l.Z.deletePost(r),t(e.filter(e=>e.id!==r))}catch(e){alert("删除失败: "+(e instanceof Error?e.message:"未知错误"))}},y=e=>{switch(e){case"published":return(0,a.jsx)(s.C,{className:"bg-green-500 hover:bg-green-600",children:"已发布"});case"draft":return(0,a.jsx)(s.C,{variant:"secondary",children:"草稿"});case"archived":return(0,a.jsx)(s.C,{variant:"outline",children:"已归档"});default:return(0,a.jsx)(s.C,{variant:"outline",children:e})}},b=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return r?(0,a.jsx)("div",{className:"container max-w-6xl mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"text-center",children:"加载中..."})}):m?(0,a.jsx)("div",{className:"container max-w-6xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-destructive mb-4",children:["加载失败: ",m]}),(0,a.jsx)(n.z,{onClick:()=>window.location.reload(),children:"重试"})]})}):(0,a.jsxs)("div",{className:"container max-w-6xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"博客管理"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"管理您的博客文章，支持OneNote HTML上传"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(n.z,{asChild:!0,children:(0,a.jsxs)(f.default,{href:"/admin/blog/new",children:[(0,a.jsx)(o,{className:"w-4 h-4 mr-2"}),"新建文章"]})}),(0,a.jsx)(n.z,{variant:"outline",asChild:!0,children:(0,a.jsx)(f.default,{href:"/admin/blog/upload",children:"上传HTML文件"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{className:"pb-2",children:(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"总文章"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.length})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{className:"pb-2",children:(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"已发布"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>"published"===e.status).length})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{className:"pb-2",children:(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"草稿"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:e.filter(e=>"draft"===e.status).length})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{className:"pb-2",children:(0,a.jsx)(i.ll,{className:"text-sm font-medium",children:"总浏览量"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.reduce((e,t)=>e+t.view_count,0)})})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.ll,{className:"text-lg",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:["创建于 ",b(e.created_at)]}),(0,a.jsxs)("span",{children:["更新于 ",b(e.updated_at)]}),e.published_at&&(0,a.jsxs)("span",{children:["发布于 ",b(e.published_at)]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.view_count})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[y(e.status),e.is_featured&&(0,a.jsx)(s.C,{className:"bg-yellow-500 hover:bg-yellow-600",children:"精选"})]})]}),e.excerpt&&(0,a.jsx)(i.SZ,{className:"line-clamp-2",children:e.excerpt})]}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[e.category&&(0,a.jsx)(s.C,{variant:"outline",children:e.category}),e.tags.slice(0,3).map(e=>(0,a.jsx)(s.C,{variant:"outline",className:"text-xs",children:e},e)),e.tags.length>3&&(0,a.jsxs)(s.C,{variant:"outline",className:"text-xs",children:["+",e.tags.length-3]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(n.z,{size:"sm",variant:"outline",asChild:!0,children:(0,a.jsxs)(f.default,{href:"/blog/".concat(e.slug),target:"_blank",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-1"}),"查看"]})}),(0,a.jsx)(n.z,{size:"sm",variant:"outline",asChild:!0,children:(0,a.jsxs)(f.default,{href:"/admin/blog/edit/".concat(e.id),children:[(0,a.jsx)(h,{className:"w-4 h-4 mr-1"}),"编辑"]})}),(0,a.jsxs)(n.z,{size:"sm",variant:"outline",onClick:()=>j(e.id,e.title),className:"text-destructive hover:text-destructive",children:[(0,a.jsx)(u,{className:"w-4 h-4 mr-1"}),"删除"]})]})]})})]},e.id))}),0===e.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"还没有任何文章"}),(0,a.jsx)(n.z,{asChild:!0,children:(0,a.jsxs)(f.default,{href:"/admin/blog/new",children:[(0,a.jsx)(o,{className:"w-4 h-4 mr-2"}),"创建第一篇文章"]})})]})]})}},4693:(e,t,r)=>{"use strict";r.d(t,{C:()=>l});var a=r(7437),s=r(7440),n=r(3027);r(2265);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:r,...n}=e;return(0,a.jsx)("div",{className:(0,s.cn)(i({variant:r}),t),...n})}},495:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});var a=r(7437),s=r(2265),n=r(1538),i=r(3027),l=r(7440);let c=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 font-primary",{variants:{variant:{default:"bg-gradient-primary text-white hover:shadow-lg hover:-translate-y-0.5 hover:shadow-blue-500/25",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground gradient-border",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"bg-gradient-primary text-white hover:shadow-lg hover:-translate-y-1 hover:shadow-blue-500/30"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-12 rounded-lg px-8 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:o=!1,...d}=e,h=o?n.g7:"button";return(0,a.jsx)(h,{className:(0,l.cn)(c({variant:s,size:i,className:r})),ref:t,...d})});o.displayName="Button"},6013:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>l,SZ:()=>o,Zb:()=>i,aY:()=>d,ll:()=>c});var a=r(7437),s=r(2265),n=r(7440);let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});i.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...s})});l.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});c.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});o.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...s})});d.displayName="CardContent",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter"},9088:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let a=r(357).env.NEXT_PUBLIC_API_URL||"http://localhost:8000",s=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new AbortController,a=setTimeout(()=>r.abort(),3e3);try{let s=await fetch(e,{...t,signal:r.signal});return clearTimeout(a),s}catch(e){if(clearTimeout(a),e instanceof Error&&"AbortError"===e.name)throw Error("请求超时");throw e}};class n{static async getPosts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;e.page&&t.set("page",e.page.toString()),e.page_size&&t.set("page_size",e.page_size.toString()),e.category&&t.set("category",e.category),e.search&&t.set("search",e.search);let r=await s("".concat(a,"/api/blog/posts?").concat(t),{cache:"force-cache",next:{revalidate:300}});if(!r.ok)throw Error("获取博客文章失败");return await r.json()}static async getPostBySlug(e){try{let t=await s("".concat(a,"/api/blog/posts/").concat(e),{cache:"force-cache",next:{revalidate:600}});if(!t.ok)return null;return await t.json()}catch(e){return null}}static async getFeaturedPosts(){let e=await s("".concat(a,"/api/blog/featured"),{cache:"force-cache",next:{revalidate:300}});if(!e.ok)throw Error("获取精选文章失败");return await e.json()}static async getCategories(){let e=await fetch("".concat(a,"/api/blog/categories"),{cache:"no-store"});if(!e.ok)throw Error("获取博客分类失败");return await e.json()}static async getAllPostsAdmin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;e.page&&t.set("page",e.page.toString()),e.page_size&&t.set("page_size",e.page_size.toString());let r=await fetch("".concat(a,"/api/admin/blog/posts?").concat(t),{cache:"no-store",headers:this.getAuthHeaders()});if(!r.ok)throw Error("获取所有文章失败");return await r.json()}static async createPost(e){let t=await fetch("".concat(a,"/api/admin/blog/posts"),{method:"POST",headers:{"Content-Type":"application/json",...this.getAuthHeaders()},body:JSON.stringify(e)});if(!t.ok)throw Error("创建文章失败");return await t.json()}static async updatePost(e,t){let r=await fetch("".concat(a,"/api/admin/blog/posts/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json",...this.getAuthHeaders()},body:JSON.stringify(t)});if(!r.ok)throw Error("更新文章失败");return await r.json()}static async deletePost(e){if(!(await fetch("".concat(a,"/api/admin/blog/posts/").concat(e),{method:"DELETE",headers:this.getAuthHeaders()})).ok)throw Error("删除文章失败")}static async uploadFile(e){let t=new FormData;t.append("file",e);let r=await fetch("".concat(a,"/api/admin/blog/upload"),{method:"POST",headers:this.getAuthHeaders(),body:t});if(!r.ok)throw Error("文件上传失败");return await r.json()}static getAuthHeaders(){return{}}}},7440:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var a=r(4839),s=r(6164);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},5733:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(1066).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},1584:(e,t,r)=>{"use strict";r.d(t,{F:()=>n,e:()=>i});var a=r(2265);function s(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(...e){return t=>{let r=!1,a=e.map(e=>{let a=s(e,t);return r||"function"!=typeof a||(r=!0),a});if(r)return()=>{for(let t=0;t<a.length;t++){let r=a[t];"function"==typeof r?r():s(e[t],null)}}}}function i(...e){return a.useCallback(n(...e),e)}},1538:(e,t,r)=>{"use strict";r.d(t,{Z8:()=>i,g7:()=>l});var a=r(2265),s=r(1584),n=r(7437);function i(e){let t=function(e){let t=a.forwardRef((e,t)=>{let{children:r,...n}=e;if(a.isValidElement(r)){let e,i;let l=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.props.ref:r.props.ref||r.ref,c=function(e,t){let r={...t};for(let a in t){let s=e[a],n=t[a];/^on[A-Z]/.test(a)?s&&n?r[a]=(...e)=>{let t=n(...e);return s(...e),t}:s&&(r[a]=s):"style"===a?r[a]={...s,...n}:"className"===a&&(r[a]=[s,n].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==a.Fragment&&(c.ref=t?(0,s.F)(t,l):l),a.cloneElement(r,c)}return a.Children.count(r)>1?a.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=a.forwardRef((e,r)=>{let{children:s,...i}=e,l=a.Children.toArray(s),c=l.find(o);if(c){let e=c.props.children,s=l.map(t=>t!==c?t:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,n.jsx)(t,{...i,ref:r,children:a.isValidElement(e)?a.cloneElement(e,void 0,s):null})}return(0,n.jsx)(t,{...i,ref:r,children:s})});return r.displayName=`${e}.Slot`,r}var l=i("Slot"),c=Symbol("radix.slottable");function o(e){return a.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===c}}},e=>{var t=t=>e(e.s=t);e.O(0,[138,289,130,215,744],()=>t(5397)),_N_E=e.O()}]);