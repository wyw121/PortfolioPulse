(()=>{var e={};e.id=63,e.ids=[63],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},8011:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,pages:()=>d,routeModule:()=>x,tree:()=>o});var a=s(3003),r=s(4293),i=s(6550),n=s.n(i),l=s(6979),c={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let o=["",{children:["admin",{children:["blog",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2575)),"D:\\repositories\\PortfolioPulse\\frontend\\app\\admin\\blog\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6877)),"D:\\repositories\\PortfolioPulse\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,2075,23)),"next/dist/client/components/not-found-error"]}],d=["D:\\repositories\\PortfolioPulse\\frontend\\app\\admin\\blog\\page.tsx"],h={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/admin/blog/page",pathname:"/admin/blog",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},1288:(e,t,s)=>{Promise.resolve().then(s.bind(s,6714))},6714:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(8819),r=s(567),i=s(772),n=s(3071),l=s(2386),c=s(6557);let o=(0,c.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var d=s(2714);let h=(0,c.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),x=(0,c.Z)("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);var u=s(434),m=s(7266);function p(){let[e,t]=(0,m.useState)([]),[s,c]=(0,m.useState)(!0),[p,g]=(0,m.useState)(null),[f]=(0,m.useState)(1);(0,m.useCallback)(async()=>{try{c(!0);let e=await l.Z.getAllPostsAdmin({page:f,page_size:20});t(e)}catch(e){g(e instanceof Error?e.message:"加载失败")}finally{c(!1)}},[f]);let j=async(s,a)=>{if(confirm(`确定要删除文章《${a}》吗？此操作不可撤销。`))try{await l.Z.deletePost(s),t(e.filter(e=>e.id!==s))}catch(e){alert("删除失败: "+(e instanceof Error?e.message:"未知错误"))}},v=e=>{switch(e){case"published":return(0,a.jsx)(r.C,{className:"bg-green-500 hover:bg-green-600",children:"已发布"});case"draft":return(0,a.jsx)(r.C,{variant:"secondary",children:"草稿"});case"archived":return(0,a.jsx)(r.C,{variant:"outline",children:"已归档"});default:return(0,a.jsx)(r.C,{variant:"outline",children:e})}},b=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return s?(0,a.jsx)("div",{className:"container max-w-6xl mx-auto px-4 py-8",children:(0,a.jsx)("div",{className:"text-center",children:"加载中..."})}):p?(0,a.jsx)("div",{className:"container max-w-6xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("p",{className:"text-destructive mb-4",children:["加载失败: ",p]}),(0,a.jsx)(i.z,{onClick:()=>window.location.reload(),children:"重试"})]})}):(0,a.jsxs)("div",{className:"container max-w-6xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"博客管理"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"管理您的博客文章，支持OneNote HTML上传"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(i.z,{asChild:!0,children:(0,a.jsxs)(u.default,{href:"/admin/blog/new",children:[(0,a.jsx)(o,{className:"w-4 h-4 mr-2"}),"新建文章"]})}),(0,a.jsx)(i.z,{variant:"outline",asChild:!0,children:(0,a.jsx)(u.default,{href:"/admin/blog/upload",children:"上传HTML文件"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"总文章"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.length})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"已发布"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>"published"===e.status).length})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"草稿"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:e.filter(e=>"draft"===e.status).length})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"总浏览量"})}),(0,a.jsx)(n.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:e.reduce((e,t)=>e+t.view_count,0)})})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.ll,{className:"text-lg",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("span",{children:["创建于 ",b(e.created_at)]}),(0,a.jsxs)("span",{children:["更新于 ",b(e.updated_at)]}),e.published_at&&(0,a.jsxs)("span",{children:["发布于 ",b(e.published_at)]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.view_count})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[v(e.status),e.is_featured&&(0,a.jsx)(r.C,{className:"bg-yellow-500 hover:bg-yellow-600",children:"精选"})]})]}),e.excerpt&&(0,a.jsx)(n.SZ,{className:"line-clamp-2",children:e.excerpt})]}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[e.category&&(0,a.jsx)(r.C,{variant:"outline",children:e.category}),e.tags.slice(0,3).map(e=>(0,a.jsx)(r.C,{variant:"outline",className:"text-xs",children:e},e)),e.tags.length>3&&(0,a.jsxs)(r.C,{variant:"outline",className:"text-xs",children:["+",e.tags.length-3]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.z,{size:"sm",variant:"outline",asChild:!0,children:(0,a.jsxs)(u.default,{href:`/blog/${e.slug}`,target:"_blank",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-1"}),"查看"]})}),(0,a.jsx)(i.z,{size:"sm",variant:"outline",asChild:!0,children:(0,a.jsxs)(u.default,{href:`/admin/blog/edit/${e.id}`,children:[(0,a.jsx)(h,{className:"w-4 h-4 mr-1"}),"编辑"]})}),(0,a.jsxs)(i.z,{size:"sm",variant:"outline",onClick:()=>j(e.id,e.title),className:"text-destructive hover:text-destructive",children:[(0,a.jsx)(x,{className:"w-4 h-4 mr-1"}),"删除"]})]})]})})]},e.id))}),0===e.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"还没有任何文章"}),(0,a.jsx)(i.z,{asChild:!0,children:(0,a.jsxs)(u.default,{href:"/admin/blog/new",children:[(0,a.jsx)(o,{className:"w-4 h-4 mr-2"}),"创建第一篇文章"]})})]})]})}},567:(e,t,s)=>{"use strict";s.d(t,{C:()=>l});var a=s(8819),r=s(7863),i=s(9360);s(7266);let n=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...s}){return(0,a.jsx)("div",{className:(0,r.cn)(n({variant:t}),e),...s})}},2386:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});let a=process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",r=async(e,t={})=>{let s=new AbortController,a=setTimeout(()=>s.abort(),3e3);try{let r=await fetch(e,{...t,signal:s.signal});return clearTimeout(a),r}catch(e){if(clearTimeout(a),e instanceof Error&&"AbortError"===e.name)throw Error("请求超时");throw e}};class i{static async getPosts(e={}){let t=new URLSearchParams;e.page&&t.set("page",e.page.toString()),e.page_size&&t.set("page_size",e.page_size.toString()),e.category&&t.set("category",e.category),e.search&&t.set("search",e.search);let s=await r(`${a}/api/blog/posts?${t}`,{cache:"force-cache",next:{revalidate:300}});if(!s.ok)throw Error("获取博客文章失败");return await s.json()}static async getPostBySlug(e){try{let t=await r(`${a}/api/blog/posts/${e}`,{cache:"force-cache",next:{revalidate:600}});if(!t.ok)return null;return await t.json()}catch{return null}}static async getFeaturedPosts(){let e=await r(`${a}/api/blog/featured`,{cache:"force-cache",next:{revalidate:300}});if(!e.ok)throw Error("获取精选文章失败");return await e.json()}static async getCategories(){let e=await fetch(`${a}/api/blog/categories`,{cache:"no-store"});if(!e.ok)throw Error("获取博客分类失败");return await e.json()}static async getAllPostsAdmin(e={}){let t=new URLSearchParams;e.page&&t.set("page",e.page.toString()),e.page_size&&t.set("page_size",e.page_size.toString());let s=await fetch(`${a}/api/admin/blog/posts?${t}`,{cache:"no-store",headers:this.getAuthHeaders()});if(!s.ok)throw Error("获取所有文章失败");return await s.json()}static async createPost(e){let t=await fetch(`${a}/api/admin/blog/posts`,{method:"POST",headers:{"Content-Type":"application/json",...this.getAuthHeaders()},body:JSON.stringify(e)});if(!t.ok)throw Error("创建文章失败");return await t.json()}static async updatePost(e,t){let s=await fetch(`${a}/api/admin/blog/posts/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",...this.getAuthHeaders()},body:JSON.stringify(t)});if(!s.ok)throw Error("更新文章失败");return await s.json()}static async deletePost(e){if(!(await fetch(`${a}/api/admin/blog/posts/${e}`,{method:"DELETE",headers:this.getAuthHeaders()})).ok)throw Error("删除文章失败")}static async uploadFile(e){let t=new FormData;t.append("file",e);let s=await fetch(`${a}/api/admin/blog/upload`,{method:"POST",headers:this.getAuthHeaders(),body:t});if(!s.ok)throw Error("文件上传失败");return await s.json()}static getAuthHeaders(){return{}}}},2714:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(6557).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2575:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>e});var r=s(1851);let e=(await (0,r.createProxy)(String.raw`D:\repositories\PortfolioPulse\frontend\app\admin\blog\page.tsx`)).default;a()}catch(e){a(e)}},1)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[234,434,686,160],()=>s(8011));module.exports=a})();